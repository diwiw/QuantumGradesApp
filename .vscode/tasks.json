{
    "version": "2.0.0",
    "tasks": [
        // ======================================================
        // CONFIGURE
        // ======================================================
        {
            "label": "Configure Debug (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--preset",
                "linux-debug"
            ],
            "group": "build"
        },
        {
            "label": "Configure Release (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--preset",
                "linux-release"
            ],
            "group": "build"
        },
        {
            "label": "Configure Profiling (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--preset",
                "linux-profiling"
            ],
            "group": "build"
        },
        // ======================================================
        // BUILD — DEBUG (Demos, Unit tests, E2E tests)
        // ======================================================
        {
            "label": "Build Debug All Demos (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-debug",
                "--parallel",
                "--target",
                "backtest_demo",
                "logger_demo",
                "grades_demo"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Debug Unit Tests (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-debug",
                "--target",
                "qga_tests",
                "--parallel"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Debug E2E Tests (preset)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-debug-e2e"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": []
        },
        // ======================================================
        // BUILD — RELEASE
        // ======================================================
        {
            "label": "Build Release All Demos (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-release",
                "--parallel",
                "--target",
                "backtest_demo",
                "logger_demo",
                "grades_demo"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Release Tests (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-release",
                "--target",
                "qga_tests",
                "--parallel"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Release E2E Tests (preset)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-release-e2e"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": []
        },
        // ======================================================
        // TEST TASKS — DEBUG (Unit & E2E)
        // ======================================================
        {
            "label": "Test Unit (Debug)",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cmake --build --preset build-linux-debug --target qga_tests -j && ctest -C Debug -L unit --output-on-failure --test-dir build/Debug"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "test",
            "problemMatcher": []
        },
        {
            "label": "Test E2E (Debug)",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cmake --build --preset build-linux-debug-e2e -j && ctest -C Debug -L e2e --output-on-failure --test-dir build/Debug"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "test",
            "problemMatcher": []
        },
        // ======================================================
        // TEST TASKS — RELEASE (Unit & E2E)
        // ======================================================
        {
            "label": "Test Unit (Release)",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cmake --build --preset build-linux-release --target qga_tests -j && ctest -C Release -L unit --output-on-failure --test-dir build/Release"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "test",
            "problemMatcher": []
        },
        {
            "label": "Test E2E (Release)",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "cmake --build --preset build-linux-release-e2e -j && ctest -C Release -L e2e --output-on-failure --test-dir build/Release"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "test",
            "problemMatcher": []
        },
        // ======================================================
        // CLI BUILDS
        // ======================================================
        {
            "label": "Build Debug CLI App",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-debug-cli",
                "--target",
                "qga_cli",
                "-j8"
            ],
            "dependsOn": [
                "Configure Debug (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Release CLI App",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-release-cli",
                "--target",
                "qga_cli",
                "-j8"
            ],
            "dependsOn": [
                "Configure Release (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Build Profiling (vcpkg)",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "--preset",
                "build-linux-profiling",
                "--parallel"
            ],
            "dependsOn": [
                "Configure Profiling (vcpkg)"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ]
        },
        {
            "label": "Run perf profiling",
            "type": "shell",
            "command": "bash",
            "args": [
                "tools/profiling/perf.sh",
                "./build/Profiling/bin/qga_cli",
                "config/perf_config.json"
            ],
            "group": "test"
        },
        // ======================================================
        // CLEAN
        // ======================================================
        {
            "label": "Clean Build",
            "type": "shell",
            "command": "rm",
            "args": [
                "-rf",
                "build"
            ],
            "group": "build"
        }
    ]
}